/*! iptools-jquery-modal - v1.0.3 - 2016-01-28
* https://github.com/interactive-pioneers/iptools-jquery-modal
* Copyright Â© 2016 Interactive Pioneers GmbH; Licensed GPL-3.0 */
!function(a,b,c){"use strict";function d(d,f){function g(){return Q.modifiers.length>0?" "+Q.modifiers:""}function h(){U&&(U.remove(),U=null,X=!1)}function i(){_.element.off("ajax:complete").off("ajax:success").off("ajax:error")}function j(){a(c).off(r("keydown")).off(r("mouseup")).off(r("touchstart")),a(b).off(r("resize"))}function k(){_.element.on(r("click"),l)}function l(b){b.preventDefault();var c=a(b.currentTarget);_.open({link:c.attr("href"),unobtrusive:c.data("remote")})}function m(b){h(),$=u(b);var c=a("<div/>").addClass(Q.modalClass+N.elements.content);return a("<div/>",{"class":Q.modalClass+g(),id:Q.modalId,width:Q.width,height:Q.height}).css("z-index",Q.zIndex).data("type",$).append(c)}function n(){X=!1,y(),Q.showSpinner&&A(),_.element.trigger(r("ready"))}function o(){B(),_.element.trigger(r("complete"))}function p(){o(),X=!0,v(),D(),s(),_.element.trigger(r("success"))}function q(){o(),z(),_.element.trigger(r("error"))}function r(a){return a+"."+e}function s(){W&&U.addClass(Q.modalClass+N.effectModifierPrefix+W),C(),U.addClass(Q.modalClass+N.activeModifier)}function t(){U.removeClass(Q.modalClass+N.activeModifier)}function u(b){if(b.unobtrusive)return M.UNOBTRUSIVE;if(b.link&&"#"===b.link.charAt(0)&&!b.unobtrusive){if(0===a(b.link).length)throw new Error("Modal content not found!");return M.STATIC}return M.DYNAMIC}function v(){Q.closeButton&&(V=a("<div/>").addClass(Q.closeButtonClass).appendTo(Q.addCloseButtonToOverlay?T:U))}function w(){T||(T=a("<div/>").addClass(Q.overlayClass).appendTo("body"))}function x(){T&&(T.remove(),T=null)}function y(){Y=!0,a("body").css("overflow","hidden"),T||w(),T.stop().fadeIn(Q.animationDuration)}function z(){T&&T.stop().fadeOut(Q.animationDuration),a("body").css("overflow","auto"),Y=!1}function A(){S||(S=a("<div/>").addClass(Q.modalClass+N.elements.spinner).addClass(Q.spinnerClass).append(Q.spinnerHTML)),S.appendTo(T).show()}function B(){S&&(S.hide(),S.remove())}function C(){var a=U.outerHeight(),b=T.height();a>b?U.removeClass(Q.modalVAlignCenterClass).addClass(Q.modalVAlignTopClass):U.removeClass(Q.modalVAlignTopClass).addClass(Q.modalVAlignCenterClass)}function D(){V&&V.on(r("click"),_.close),Q.closeOnESC&&a(c).on(r("keydown"),I),Q.closeOnClickOutside&&a(c).on(r("mouseup"),J).on(r("touchstart"),J),a(b).on(r("resize"),K)}function E(){_.element.on("ajax:complete",F).on("ajax:success",G).on("ajax:error",H)}function F(){o()}function G(){p()}function H(){q()}function I(a){Y&&27===a.which&&_.close()}function J(a){Y&&!U.is(a.target)&&0===U.has(a.target).length&&_.close()}function K(){clearTimeout(Z),Z=setTimeout(function(){C()},250)}function L(){W=_.element.data(O.effect),R=_.element.attr("href"),k()}var M={STATIC:"static",DYNAMIC:"dynamic",UNOBTRUSIVE:"unobtrusive"},N={activeModifier:"--active",effectModifierPrefix:"--effect-",overlay:"overlay",spinnerModifier:"--default",modal:{name:"modal",verticalAlignTop:"modal--vertical-align-top",verticalAlignCenter:"modal--vertical-align-center"},elements:{closeButton:"__button-close",spinner:"__spinner",content:"__content"}},O={effect:"modal-effect"},P={animationDuration:500,closeOnESC:!0,closeOnClickOutside:!0,closeButton:!0,closeButtonClass:N.modal.name+N.elements.closeButton,addCloseButtonToOverlay:!1,overlayClass:N.overlay,modalClass:N.modal.name,modalId:N.modal.name,modalVAlignTopClass:N.modal.verticalAlignTop,modalVAlignCenterClass:N.modal.verticalAlignCenter,modifiers:"",showSpinner:!0,spinnerClass:N.modal.name+N.elements.spinner+N.spinnerModifier,spinnerHTML:"",width:"80%",height:"auto",zIndex:102};this.element=a(d);var Q=a.extend({},P,f),R=null,S=null,T=null,U=null,V=null,W=null,X=!1,Y=!1,Z=0,$=M.STATIC,_=this;this.getSettings=function(){return Q},this.getModal=function(){return U},this.getOverlay=function(){return T},this.getEffect=function(){return W},this.active=function(){return U.hasClass(Q.modalClass+N.activeModifier)},this.destroy=function(){j(),i(),h(),x(),this.element.off(r("click")).removeData("plugin_"+e)},this.open=function(b){if(!b)throw new Error("Data for modal launch missing!");if(!b.link)throw new Error("Link to modal content missing!");switch(w(),U=m(b).appendTo(T),n(),$){case M.STATIC:_.setContent(a(R).html()),p();break;case M.DYNAMIC:a.get(R).done(function(a){_.setContent(a),p()}).fail(function(){q()});break;case M.UNOBTRUSIVE:E();break;default:throw new Error("Invalid modal type!")}},this.close=function(){t(),z(),j(),i(),h()},this.setContent=function(a){U.find("."+Q.modalClass+N.elements.content).html(a)},L()}var e="iptModal";a.fn[e]=function(b){return this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new d(this,b))})}}(jQuery,window,document);